<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pybedtools.contrib.long_range_interaction.tag_bedpe &#8212; pybedtools 0.10.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=82662543"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pybedtools.contrib.long_range_interaction.cis_trans_interactions" href="pybedtools.contrib.long_range_interaction.cis_trans_interactions.html" />
    <link rel="prev" title="pybedtools.contrib.venn_maker.cleaned_intersect" href="pybedtools.contrib.venn_maker.cleaned_intersect.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pybedtools-contrib-long-range-interaction-tag-bedpe">
<h1>pybedtools.contrib.long_range_interaction.tag_bedpe<a class="headerlink" href="#pybedtools-contrib-long-range-interaction-tag-bedpe" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="pybedtools.contrib.long_range_interaction.tag_bedpe">
<span class="sig-prename descclassname"><span class="pre">pybedtools.contrib.long_range_interaction.</span></span><span class="sig-name descname"><span class="pre">tag_bedpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bedpe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pybedtools/contrib/long_range_interaction.html#tag_bedpe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pybedtools.contrib.long_range_interaction.tag_bedpe" title="Link to this definition">¶</a></dt>
<dd><p>Tag each end of a BEDPE with a set of (possibly many) query BED files.</p>
<p>For example, given a BEDPE of interacting fragments from a Hi-C experiment,
identify the contacts between promoters and ChIP-seq peaks. In this case,
promoters and ChIP-seq peaks of interest would be provided as BED files.</p>
<p>The strategy is to split the BEDPE into two separate files.  Each file is
intersected independently with the set of queries.  The results are then
iterated through in parallel to tie the ends back together. It is this
iterator that is returned (see example below).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>bedpe</strong><span class="classifier">str</span></dt><dd><p>BEDPE-format file. Must be name-sorted.</p>
</dd>
<dt><strong>queries</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of BED/GFF/GTF/VCF files to use. After splitting the BEDPE,
these query files (values in the dictionary) will be passed as the <code class="file docutils literal notranslate"><span class="pre">-b</span></code>
arg to <code class="file docutils literal notranslate"><span class="pre">bedtools</span> <span class="pre">intersect</span></code>. The keys are passed as the <code class="file docutils literal notranslate"><span class="pre">names</span></code>
argument for <code class="file docutils literal notranslate"><span class="pre">bedtools</span> <span class="pre">intersect</span></code></p>
<p><em>Features in each file must have unique names</em>. Use
<code class="xref py py-func docutils literal notranslate"><span class="pre">pybedtools.featurefuncs.UniqueID()</span></code> to help fix this.</p>
<p><em>Each file must be BED3 to BED6</em>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Tuple of (iterator, n, extra).</dt><dd></dd>
<dt><code class="file docutils literal notranslate"><span class="pre">iterator</span></code> is described below. <code class="file docutils literal notranslate"><span class="pre">n</span></code> is the total number of lines in the</dt><dd></dd>
<dt>BEDPE file, which is useful for calculating percentage complete for</dt><dd></dd>
<dt>downstream work. <code class="file docutils literal notranslate"><span class="pre">extra</span></code> is the number of extra fields found in the BEDPE</dt><dd></dd>
<dt>(also useful for downstream processing).</dt><dd></dd>
<dt><code class="file docutils literal notranslate"><span class="pre">iterator</span></code> yields tuples of (label, end1_hits, end2_hits) where <code class="file docutils literal notranslate"><span class="pre">label</span></code> is</dt><dd></dd>
<dt>the name field of one line of the original BEDPE file. <code class="file docutils literal notranslate"><span class="pre">end1_hits</span></code> and</dt><dd></dd>
<dt><code class="file docutils literal notranslate"><span class="pre">end2_hits</span></code> are each iterators of BED-like lines representing all</dt><dd></dd>
<dt>identified intersections across all query BED files for end1 and end2 for</dt><dd></dd>
<dt>this pair.</dt><dd></dd>
<dt>Recall that BEDPE format defines a single name and a single score for each</dt><dd></dd>
<dt>pair. For each item in <code class="file docutils literal notranslate"><span class="pre">end1_hits</span></code>, the fields are::</dt><dd><p>chrom1
start1
end1
name
score
strand1
[extra fields]
query_label
fields_from_query_intersecting_end1</p>
</dd>
<dt>where <code class="file docutils literal notranslate"><span class="pre">[extra</span> <span class="pre">fields]</span></code> are any additional fields from the original BEDPE,</dt><dd></dd>
<dt><code class="file docutils literal notranslate"><span class="pre">query_label</span></code> is one of the keys in the <code class="file docutils literal notranslate"><span class="pre">beds</span></code> input dictionary, and the</dt><dd></dd>
<dt>remaining fields in the line are the intersecting line from the</dt><dd></dd>
<dt>corresponding BED file in the <code class="file docutils literal notranslate"><span class="pre">beds</span></code> input dictionary.</dt><dd></dd>
<dt>Similarly, each item in <code class="file docutils literal notranslate"><span class="pre">end2_hits</span></code> consists of:</dt><dd><p>chrom2
start2
end2
name
score
strand2
[extra fields]
query_label
fields_from_query_intersecting_end2</p>
</dd>
<dt>At least one line is reported for every line in the BEDPE file. If there</dt><dd></dd>
<dt>was no intersection, the standard BEDTools null fields will be shown. In</dt><dd></dd>
<dt><code class="file docutils literal notranslate"><span class="pre">end1_hits</span></code> and <code class="file docutils literal notranslate"><span class="pre">end2_hits</span></code>, a line will be reported for each hit in each</dt><dd></dd>
<dt>query.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pybedtools</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../main.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main.html#running-tests-compiling-docs">Running tests, compiling docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3-brief-examples.html">Three brief examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial-contents.html">Tutorial Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topical-documentation-contents.html">Topical Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts.html">Scripts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../autodoc_source.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pybedtools</span></code> Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#bedtool-creation"><code class="xref py py-class docutils literal notranslate"><span class="pre">BedTool</span></code> creation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#bedtools-wrappers"><code class="file docutils literal notranslate"><span class="pre">BEDTools</span></code> wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#other-bedtool-methods">Other <code class="xref py py-class docutils literal notranslate"><span class="pre">BedTool</span></code> methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../autodoc_source.html#module-level-functions">Module-level functions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../autodoc_source.html#pybedtools-contrib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pybedtools.contrib</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../autodoc_source.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pybedtools</span></code> Reference</a><ul>
      <li>Previous: <a href="pybedtools.contrib.venn_maker.cleaned_intersect.html" title="previous chapter">pybedtools.contrib.venn_maker.cleaned_intersect</a></li>
      <li>Next: <a href="pybedtools.contrib.long_range_interaction.cis_trans_interactions.html" title="next chapter">pybedtools.contrib.long_range_interaction.cis_trans_interactions</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pybedtools.contrib.long_range_interaction.cis_trans_interactions.html" title="pybedtools.contrib.long_range_interaction.cis_trans_interactions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pybedtools.contrib.venn_maker.cleaned_intersect.html" title="pybedtools.contrib.venn_maker.cleaned_intersect"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pybedtools 0.10.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../autodoc_source.html" accesskey="U"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pybedtools</span></code> Reference</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pybedtools.contrib.long_range_interaction.tag_bedpe</a></li> 
      </ul>
    </div>


    <div class="footer">
      &#169;2010-2015, Ryan Dale.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/autodocs/pybedtools.contrib.long_range_interaction.tag_bedpe.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>